<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sports.persistance.mapper.BasketMapper">
	<insert id="insertCustomerAddBasekt" parameterType="BasketDTO">
		INSERT INTO BASKET_INFO
		(
			USER_NO,
			PROD_NO,
			PROD_QTY,
			REG_USER_NO,
			REG_DT,
			STATUS,
			BSK_PRICE
		)
		VALUES
		(
			#{user_no},
			#{prod_no},
			#{prod_qty},
			#{reg_user_no},
			NOW(),
			'Y',
			#{bsk_price}
		)
	</insert>
	<insert id="insertCustormerBasketOption" parameterType="list">
		INSERT INTO BASKET_OPTION
		(
			BSK_NO,
			OPT_NO,
			OPT_NAME,
			OPT_KIND,
			REG_USER_NO,
			REG_DT
		)
		VALUES
		<foreach collection="list" item="item" index="index" separator=",">
			((SELECT MAX(BSK_NO) FROM BASKET_INFO), #{item.opt_no}, #{item.opt_name}, #{item.opt_kind}, #{item.reg_user_no}, NOW())
		</foreach>
	</insert>
	<insert id="insertCustomerAddBasketNoOption" parameterType="BasketDTO">
		INSERT INTO BASKET_INFO
		(
			USER_NO,
			PROD_NO,
			PROD_QTY,
			REG_USER_NO,
			REG_DT,
			STATUS,
			BSK_PRICE
		)
		VALUES
		(
			#{user_no},
			#{prod_no},
			#{prod_qty},
			#{user_no},
			NOW(),
			'Y',
			#{bsk_price}
		)
	</insert>
	<select id="getCustomerBasketList" parameterType="string" resultType="BasketDTO">
		SELECT 
		    PI.PROD_NO,
		    PI.PROD_NAME,
		    BI.BSK_PRICE,
		    BI.BSK_NO,
		    BI.USER_NO,
		    BI.PROD_QTY
		FROM 
		   PRODUCT_INFO PI, 
		    BASKET_INFO BI
		WHERE
		   BI.USER_NO = #{userNo} AND BI.STATUS = 'Y' AND BI.PROD_NO = PI.PROD_NO;
	</select>
	<select id="getCustomerBasketOptionList" parameterType="string" resultType="Basket_OptionDTO">
		SELECT
		    BI.USER_NO,
		    BO.OPT_NO,
		    BO.OPT_NAME,
		    BO.OPT_KIND,
		    BI.STATUS
		FROM
		   BASKET_OPTION BO,
		    BASKET_INFO BI
		WHERE
		   BI.USER_NO = #{userNo} AND BI.STATUS = 'Y' AND BO.BSK_NO = #{bskNo} AND BO.BSK_NO = BI.BSK_NO;
	</select>
	<update id="updateCustomerBasketDeleteOne" parameterType="string">
		UPDATE 
			BASKET_INFO
		SET
			STATUS = 'N'
		WHERE
			BSK_NO = #{bskNo}
	</update>
</mapper>